<?xml version="1.0" ?>

<container xmlns="http://www.symfony-project.org/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.symfony-project.org/schema/dic/services http://www.symfony-project.org/schema/dic/services/services-1.0.xsd">

    <parameters>
        <parameter key="imageresiser.cache.class">Doctrine\Common\Cache\MemcacheCache</parameter>
        <parameter key="imageresiser.loader.class">Bundle\Adenclassifieds\ImageResizerBundle\Image\Loader</parameter>
        <parameter key="imageresiser.processor.class">Bundle\Adenclassifieds\ImageResizerBundle\Image\Processor</parameter>
        <parameter key="imageresiser.resizer.class">Bundle\Adenclassifieds\ImageResizerBundle\Image\Resizer</parameter>
    </parameters>

    <services>
        <service id="imageresizer.cache" class="%imageresiser.cache.class%">
            <call method="setMemcache">
	            <argument type="service">
	                <service class="Memcache">
	                    <call method="connect">
	                        <argument>localhost</argument>
	                        <argument>11211</argument>
	                    </call>
	                </service>
	            </argument>
            </call>
        </service>
        <service id="imageresizer.loader" class="%imageresiser.loader.class%">
            <argument type="service">
                <service class="Imagick" shared="false" />
            </argument> 
            <argument type="service" id="imageresizer.cache" />
            <argument>/tmp</argument>
        </service>
        <service id="imageresizer.processor" class="%imageresiser.processor.class%">
            <argument type="service" id="imageresizer.loader" />
            <argument type="service" id="imageresizer.resizer" />
            <argument type="collection">
              <argument type="collection" key="32">
                <argument>32</argument>
                <argument>32</argument>
              </argument>
            </argument>
        </service>
        <service id="imageresizer.resizer" class="%imageresiser.resizer.class%">
        </service>
    </services>
</container>
